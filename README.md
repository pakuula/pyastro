# Генерация гороскопа в командной строке

Этот проект предназначен для генерации гороскопов на основе астрологических данных, введенных пользователем через командную строку или файл.

Программа поддерживает различные форматы ввода, файлы JSON и YAML, и может экспортировать результаты в SVG, PNG, HTML, Markdown и PDF.

## Установка

Для установки необходимых зависимостей выполните следующую команду:

```bash
git clone https://github.com/pakuula/pyasrtro.git
cd pyastro
python3.12 -m venv .venv
source .venv/bin/activate
pip install -e .
```

## Использование

Для генерации гороскопа выполните команду:

```
source .venv/bin/activate
pyastro <параметры>
```

Запуск `pyastro`:

```bash
pyastro [-h] [-n NAME] [-l LOCATION] [-d DATE] [-t TIME] [-z TIME_ZONE] [--date-only] [-i INPUT_FILE] [-o OUTPUT_NAME] [-D OUTPUT_DIR] [--png] [--svg] [--svg-chart] [--text] [--html] [--pdf] [-P] [-v]
```

Опции командной строки:

```text
  -h, --help            show this help message and exit
  -v, --verbose         Выводить отладочную информацию (по умолчанию False)

Параметры натальной карты:
  Задание параметров натальной карты в командной строке

  -n, --name NAME       Имя человека, для которого строится карта
  -l, --location LOCATION
                        Местоположение в формате LAT,LON (широта, долгота)
  -d, --date DATE       Дата в формате YYYY-MM-DD
  -t, --time TIME       Время в формате H:M:S (24-часовой формат) или H:M:S AM/PM (12-часовой формат) 
                        - необязательно, если указана опция --date-only
  -z, --time-zone TIME_ZONE
                        Часовой пояс в формате Europe/Moscow или смещение от гринвича в формате -08:00 
                        - необязательно, если указана опция --date-only
  --date-only           Использовать только дату без времени (по умолчанию False)

Параметры входных файлов:
  Задание параметров из входных файлов (пока не реализовано)

  -i, --input-file INPUT_FILE
                        Имя входного файла с параметрами (пока не реализовано)

Параметры выходных файлов:
  Настройка типов выходных файлов

  -o, --output-name OUTPUT_NAME
                        Имя для файлов вывода (без расширения), по умолчанию используется параметр -n
  -D, --output-dir OUTPUT_DIR
                        Каталог для файлов вывода
  --png                 Генерировать PNG (по умолчанию False)
  --svg                 Генерировать SVG документ (по умолчанию False)
  --svg-chart           Генерировать SVG диаграмму (по умолчанию False)
  --text                Генерировать Markdown (по умолчанию False)
  --html                Генерировать HTML (по умолчанию False)
  --pdf                 Генерировать PDF (по умолчанию False)
  -P, --no-print        Не выводить текстовую информацию в консоль (по умолчанию False)
```

### Форматы входных данных

Программа поддерживает следующие форматы входных данных:

- JSON
- YAML

Формат входных данных должен содержать следующие поля:

```yaml
name: "Имя" 
event: # данные события (обязательно)
  kind: "Тип события (например, 'natal')" # необязательно, используется для документирования файла, игнорируется при генерации
  datetime: # данные даты и времени события (обязательно)
    date: "YYYY-MM-DD" # дата в формате ГГГГ-ММ-ДД, (обязательно)
    time: "HH:MM:SS" # время в формате ЧЧ:ММ:СС, ЧЧ:ММ, ЧЧ, а также форматы с AM/PM (обязательно, если не указана опция date_only)
    tz: "Часовой пояс или смещение" # часовой пояс в формате Europe/Moscow или смещение от гринвича в формате -08:00 (обязательно, если не указана опция date_only)
    date_only: false # использовать только дату без времени (необязательно, по умолчанию false)
  location:
    place: "Местоположение" # Название места события (необязательно), используется для документирования файла, игнорируется при генерации
    latitude: "DEG MIN SEC N/S" # Широта в формате градусы, минуты, секунды и направление (обязательно)
    # Также поддерживаются форматы с десятичной точкой, например: "34.05 S" или -34.05, и формат с градусами и десятичными минутами, например: 34°03'00"S
    longitude: "DEG MIN SEC E/W" # Долгота в формате градусы, минуты, секунды и направление (обязательно)
    # Также поддерживаются форматы с десятичной точкой, например: "118.25 W" или -118.25, и формат с градусами и десятичными минутами, например: 118°15'00"W
```

В JSON используется та же структура, но с соответствующим синтаксисом JSON:

```json
{
  "name": "Имя",
  "event": {
    "kind": "Тип события (например, 'natal')",
    "datetime": {
      "date": "YYYY-MM-DD",
      "time": "HH:MM:SS",
      "tz": "Часовой пояс или смещение",
      "date-only": false
    },
    "location": {
      "place": "Местоположение",
      "latitude": "DEG MIN SEC N/S",
      "longitude": "DEG MIN SEC E/W"
    }
  }
}
```

## Примеры

### Пример использования с параметрами командной строки

```bash
pyastro -n "Jane Doe" -l "34.05,-118.25" -d "1929-06-01" -t "09:30:00" --time-zone=-8:00 --text --html --pdf -D "./output" -P
```

При вызове команды с часовым поясом в формате `-z -08:00`, программа некорректно интерпретирует значение `-08:00` как ещё одну опцию,
а не как значение для параметра `--time-zone`. Поэтому рекомендуется параметр для часового пояса передавать в формате `--time-zone=-08:00`.

Вывод программы будет следующим:

```text
INFO: Markdown сохранён в /home/user/python/astro/output/Jane Doe.md
INFO: HTML сохранён в /home/user/python/astro/output/Jane Doe.html
INFO: PDF сохранён в /home/user/python/astro/output/Jane Doe.pdf
```

Программа использует значение параметра `-n` для имени выходных файлов.

### Пример использования с входным файлом

```yaml
name: "Jane Doe"
event:
  kind: "natal"
  datetime:
    date: "1929-06-01"
    time: "09:30:00"
    tz: "-08:00"
  location:
    place: "Los Angeles, CA"
    latitude: "34 03 N"
    longitude: "118 15 W"
```

Сохраните этот файл как `jane_doe.yaml`, затем выполните команду:

```bash
pyastro -i jane_doe.yaml --text --html --pdf -D "./output" -P
```

Вывод программы будет следующим:

```text
INFO: Markdown сохранён в /home/user/python/astro/output/jane_doe.md
INFO: HTML сохранён в /home/user/python/astro/output/jane_doe.html
INFO: PDF сохранён в /home/user/python/astro/output/jane_doe.pdf
```

Программа использует имя файла без расширения в качестве имени выходных файлов, если параметр `-o` не указан.